{% extends 'base.html' %}
{% block title %}Stock Sage - 홈{% endblock %}
{% block content %}
    <style> {% comment %} 최근 검색 종목 임시로 추가한 스타일{% endcomment %}
        .recent-search-box {
            display: flex; /* 아이템을 가로로 나열 */
            overflow-x: auto; /* 가로 스크롤 가능하도록 설정 */
            border: 1px solid #ddd;
            white-space: nowrap; /* 줄 바꿈 방지 */
        }

        .recent-stock-item {
            flex: 0 0 auto; /* 아이템이 가로로 나열되도록 설정 */
            margin-right: 10px;
            padding: 5px 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .recent-stock-item a {
            text-decoration: none; /* 링크 밑줄 제거 */
            color: #333;
        }

        .recent-stock-item a:hover {
            text-decoration: underline; /* 링크에 호버 시 밑줄 추가 */
        }

        .no-recent-stocks {
            padding: 10px;
            color: #777;
        }
    </style>
<body>
    <div class="container">
        <div class="content-wrap">
            <div class="main-content">
                <div class="tab-header">
                    <div class="tab" id="tab1" onclick="switchTab('content1')">코스피</div>
                    <div class="tab" id="tab3" onclick="switchTab('content3')">코스피200</div>
                </div>
                <div class="highlight-bar"></div>
                <div class="chart-container">
                    <div class="chart">
                        <img src="data:image/png;base64,{{ kospi_chart }}" alt="KOSPI Chart"/>
                    </div>
                </div>
                <div class="tab-footer-container">
                    <div class="tab-footer" id="tab-left" onclick="moveLeft()">왼쪽</div>
                    <div class="tab-footer" id="tab-right" onclick="moveRight()">오른쪽</div>
                </div>
            </div>
            <div class="sidebar">
                <div class="sidebar-section sidebar-top">
                    <div class="top-content">
                        <h2>인기검색종목</h2>
                        <div class="top-stocks">
                            <div class="stock-item">삼성전자 <span class="stock-price">76,700</span></div>
                            <div class="stock-item">SK하이닉스 <span class="stock-price">110,000</span></div>
                            <div class="stock-item">LG전자 <span class="stock-price">70,500</span></div>
                            <div class="stock-item">현대차 <span class="stock-price">160,000</span></div>
                            <div class="stock-item">기아 <span class="stock-price">82,500</span></div>
                        </div>
                    </div>
                    <div class="bottom-content">
                        <h2>글로벌지수</h2>
                        <div class="global-indexes">
                            <div class="index-item">다우존스 <span class="index-value">34,000</span></div>
                            <div class="index-item">나스닥 <span class="index-value">14,000</span></div>
                            <div class="index-item">S&amp;P500 <span class="index-value">4,500</span></div>
                            <div class="index-item">상해종합 <span class="index-value">3,500</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="additional-content">
            <div class="recent-actions">
                <div class="recent-list">
                    <div class="recent-title">최근 검색 종목</div>
                    <div class="recent-search-box">
                        {% for stock in recent_stocks %}
                            <div class="recent-stock-item"><a href="stock/info/?ticker={{stock.stock_code}}">
                                {{ stock.stock_name }}</a></div>
                        {% empty %}
                            {% if request.session.id %}
                                <div class="no-recent-stocks">최근 검색된 종목이 없습니다.</div>
                            {% else %}
                                <div class="no-recent-stocks">로그인 시 이용 가능합니다</div>
                            {% endif %}

                        {% endfor %}
                    </div>
                    <div class="bookmark-form">
                        <button class="bookmark-button">북마크</button>
                    </div>
                </div>
            </div>
            <div class="stock-tabs">
                <div class="stock-tab">
                    <div class="stock-tab-title">상승률 상위</div>
                    <div class="stock-table">
                        <div class="stock-table-header">
                            <span class="header-name">종목명</span>
                            <span class="header-ratio">상승률</span>
                            <span class="header-chart">차트</span>
                        </div>
                        {% for s in top_10_stocks %}
                        <div class="stock-details">
                            <span>{{ s.name }}</span>
                            <span class="{% if s.change > 0 %}change-positive{% else %}change-negative{% endif %}">
            {% if s.change > 0 %}
                +{{ s.chagesRatio }}
            {% else %}
                {{ s.chagesRatio }}
            {% endif %}
        </span>
                            <div class="bar-container">
                                <div class="bar" style="width: 50%;"></div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="stock-tab">
                    <div class="stock-tab-title">하락률 상위</div>
                    <div class="stock-table">
                        <div class="stock-table-header">
                            <span class="header-name">종목명</span>
                            <span class="header-ratio">하락률</span>
                            <span class="header-chart">차트</span>
                        </div>
                        {% for s in row_10_stocks %}
                        <div class="stock-details">
                            <span>{{ s.name }}</span>
                            <span class="{% if s.chagesRatio > 0 %}change-positive{% else %}change-negative{% endif %}">
                            {% if s.chagesRatio > 0 %}
                            +{{ s.chagesRatio }}%
                            {% else %}
                            {{ s.chagesRatio }}%
                            {% endif %}
                            </span>

                            <div class="bar-container">
                                    
                                    <div class="bar" style="width: {% if s.chagesRatio > 0 %}{{ s.chagesRatio }}{% else %}0{% endif %}%;"></div>

                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="stock-tab">
                    <div class="stock-tab-title">시가총액 상위</div>
                    <div class="stock-table">
                        <div class="stock-table-header">
                            <span class="header-name">종목명</span>
                            <span class="header-ratio">변동률</span>
                            <span class="header-marcap">시가총액</span>
                        </div>
                        {% for s in top_10_tot %}
                        <div class="stock-details">
                            <span>{{ s.name }}</span>
                            <span class="{% if s.chagesRatio > 0 %}change-positive{% else %}change-negative{% endif %}">
                                {% if s.chagesRatio > 0 %}
                                    +{{ s.chagesRatio }}%
                                {% elif s.chagesRatio < 0 %}
                                    {{ s.chagesRatio }}%
                                {% else %}
                                    {{ s.chagesRatio }}%
                                {% endif %}
                            </span>
                          
                        </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
          
            <div class="market-trend">
                <div class="market-section">
                    <div class="market-section-title">업종별 시세</div>
                    <div class="stock-table">
                        <div class="stock-table-header">
                            <span class="header-name">업종명</span>
                            <span class="header-ratio">변동률</span>
                            <span class="header-chart">차트</span>
                        </div>
                        <div class="stock-details">
                            <span>반도체</span>
                            <span>+2.50%</span>
                            <div class="bar-container">
                                <div class="bar" style="width: 25%;"></div>
                            </div>
                        </div>
                        <div class="stock-details">
                            <span>자동차</span>
                            <span>+1.20%</span>
                            <div class="bar-container">
                                <div class="bar" style="width: 12%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="market-section">
                    <div class="market-section-title">테마별 시세</div>
                    <div class="stock-table">
                        <div class="stock-table-header">
                            <span class="header-name">테마명</span>
                            <span class="header-ratio">변동률</span>
                            <span class="header-chart">차트</span>
                        </div>
                        <div class="stock-details">
                            <span>친환경</span>
                            <span>+3.00%</span>
                            <div class="bar-container">
                                <div class="bar" style="width: 30%;"></div>
                            </div>
                        </div>
                        <div class="stock-details">
                            <span>바이오</span>
                            <span>+2.00%</span>
                            <div class="bar-container">
                                <div class="bar" style="width: 20%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="exchange-rate">
                <div class="exchange-title">환율 정보</div>
                <table class="exchange-table">
                    <thead>
                        <tr>
                            <th>통화</th>
                            <th>매매기준율</th>
                            <th>변동률</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>USD/KRW</td>
                            <td>1,200</td>
                            <td>+0.50%</td>
                        </tr>
                        <tr>
                            <td>EUR/KRW</td>
                            <td>1,400</td>
                            <td>+0.30%</td>
                        </tr>
                        <tr>
                            <td>JPY/KRW</td>
                            <td>1,100</td>
                            <td>-0.20%</td>
                        </tr>
                        <tr>
                            <td>CNY/KRW</td>
                            <td>180</td>
                            <td>+0.10%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
<script>
    function switchTab(tabId) {
        console.log("Switching to tab: " + tabId);
    }

    function moveLeft() {
        console.log("Moving left");
    }

    function moveRight() {
        console.log("Moving right");
    }
</script>
{% endblock %}
